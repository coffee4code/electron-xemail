var angular=require("angular"),remote=require("electron").remote;angular.module("app.controller",[]).controller("appCtrl",["$rootScope","$scope","$mdColors",function(a,b,c){}]).controller("menuCtrl",["$scope","$state","$mdDialog",function(a,b,c){function d(){b.go("app.open")}function e(){var a=remote.getCurrentWindow();a.close()}function f(){b.go("app.setting")}function g(a){i("help",a)}function h(a){i("about",a)}function i(a,b){c.show({controller:j,templateUrl:"tmpls/dialogs/dialog."+a+".html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:!1})}function j(a,b){a.hide=function(){b.hide()}}a.onOpen=d,a.onExit=e,a.onSetting=f,a.onHelp=g,a.onAbout=h}]).controller("dialogHelpCtrl",["$scope",function(a){}]).controller("contentCtrl",["$scope",function(a){}]).controller("contentCtrl",["$scope",function(a){}]).controller("openCtrl",["$scope","$state","$filter","$mdToast",function(a,b,c,d){function e(b){var e=!1;return b&&b.path&&(e=c("filetype")(b.path,a.current.fileType.join(","))),e?(a.current.status=1,void(a.current.file=b)):(a.current.status=-1,d.show(d.simple().textContent("不支持的文件类型!").position("bottom center")),!1)}function f(){a.current.file&&b.go("app.list",{path:a.current.file.path})}a.current={status:0,fileType:["xls","xlsx"],file:null},a.onFileChange=e,a.onStart=f}]).controller("listCtrl",["$scope","$state","path",function(a,b,c){a.path=c}]).controller("settingCtrl",["$scope","settingService",function(a,b){}]);var angular=require("angular");angular.module("app.directive",[]).directive("myContent",[function(){return{restrict:"EAC",link:function(a,b,c){$(b).addClass("min-content")}}}]).directive("myDropZone",function(){return{restrict:"A",scope:{onFileDrop:"="},link:function(a,b){b.bind("drop",function(b){b.stopPropagation(),b.preventDefault();var c=null;b&&b.dataTransfer&&b.dataTransfer.files&&b.dataTransfer.files.length&&(c=b.dataTransfer.files[0]),a.onFileDrop(c)}),b.bind("dragover",function(a){a.preventDefault(),$(this).addClass("drop-active")}),b.bind("dragleave",function(a){a.preventDefault(),$(this).removeClass("drop-active")}),$(window).bind("drop dragover",function(a){a.preventDefault()})}}}).directive("myFilePicker",[function(){return{restrict:"EA",scope:{fileType:"=",myOnChange:"="},template:'<div>   <div class="drop-area" id="file-drop-area" my-drop-zone on-file-drop="onFileDrop">      <div class="drop-area-icon">          <ng-md-icon icon="cloud_download" size="100" style="fill:{{$root.mdPrimaryColor}};"></ng-md-icon>      </div>      <div class="drop-area-tip" ng-if="!!current.filePath" ng-bind="current.filePath"></div>      <div class="drop-area-tip" ng-if="!current.filePath">点击选择xls文件或将文件拖放到这里</div>   </div>   <input id="file-input" type="file" my-on-change="onFileChange" style="display: none;"></div>',replace:!0,link:function(a,b,c){function d(b){a.current.filePath=b.path,a.$apply(function(){a.myOnChange(b)})}function e(){g.bind("change",function(b){a.$apply(function(){var c=null;b.target&&b.target.files&&b.target.files.length&&(c=b.target.files[0]),a.current.filePath=c.path,a.myOnChange(c)})}),h.bind("click",function(a){g.trigger("click")})}a.current={filePath:""},a.onFileDrop=d;var f=$(b),g=f.find("#file-input"),h=f.find("#file-drop-area");e()}}}]);var angular=require("angular"),ngRouter=require("angular-ui-router");angular.module("app.router",[ngRouter]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){c.hashPrefix("!"),b.otherwise("/open"),a.state("app",{url:"","abstract":!0,views:{menu:{templateUrl:"tmpls/menu.html",controller:"menuCtrl"},content:{templateUrl:"tmpls/content.html",controller:"contentCtrl"}}}).state("app.open",{url:"/open",views:{main:{templateUrl:"tmpls/open.html",controller:"openCtrl"}}}).state("app.list",{url:"/list?path",views:{main:{templateUrl:"tmpls/list.html",controller:"listCtrl",params:["path"],resolve:{path:["$stateParams",function(a){return a.path}]}}}}).state("app.setting",{url:"/setting",views:{main:{templateUrl:"tmpls/setting.html",controller:"settingCtrl"}}})}]);var angular=require("angular");angular.module("app.service",[]).service("settingService",["config","databaseService",function(a,b){function c(){var a="DROP TABLE IF EXISTS "+k+"; CREATE TABLE "+k+" (itemKey, itemValue);",c=[];for(var d in j)c.push("INSERT INTO "+k+" VALUES ('"+d+"','"+j[d]+"')");b.createWithData(k,a+c.join(";"))}function d(){var a=[],c=b.queryTableData(k);return a=i(c)}function e(a){var c=null,d=b.queryByString(k,"SELECT * FROM "+k+" WHERE itemKey=:key;",{":key":a});return d&&(c=[],c[d.itemKey]=d.itemValue),c}function f(a,c){return b.updateByString(k,"UPDATE "+k+' SET itemValue="'+c+'" WHERE itemKey="'+a+'";')}function g(a){var c=[];for(var d in a)c.push((c.length?" OR ":"")+' itemKey="'+a[d]+'" ');c=c.join(" "),c="SELECT * FROM "+k+" WHERE "+c;var e=b.updateByString(k,c),f=i(e);return f}function h(a){var c=[];for(var d in a)c.push("UPDATE "+k+' SET itemValue="'+a[d]+'" WHERE itemKey="'+d+'"');return c=c.join(";"),b.updateByString(k,c)}function i(a){var b=[];if(a&&a.length&&(a=a[0].values),a&&a.length)for(var c in a)b[a[c][0]]=a[c][1];return b}var j=a.get().SETTINGS,k="setting";return{init:c,getAll:d,getItem:e,setItem:f,getItemBatch:g,setItemBatch:h}}]);var angular=require("angular");angular.module("app.config",[]).provider("config",[function(){function a(){return c}function b(a){c.SETTINGS=a}var c={SETTINGS:{}};this.setSetting=b,this.$get=function(){return{get:a}}}]).config(["configProvider",function(a){var b={smtp_host:"smtp.qq.com",smtp_port:"465",sender_email:"1062893543@qq.com",sender_password:"anqckibffhrpbcef"};a.setSetting(b)}]);var angular=require("angular"),fs=require("fs"),SQL=require("sql.js"),path=require("path");angular.module("app.database",[]).service("databaseService",[function(){function a(a,b){if(!(i&&i[a]||e(a))){var c=new SQL.Database;c.run(b),i[a]=c,g(a)}}function b(a,b,c){var d=null;if(f(a),i&&i[a]){var e=i[a],g=e.prepare(b);d=g.getAsObject(c)}return d}function c(a,b){var c=null;if(f(a),i&&i[a]){var d=i[a];c=d.exec(b),g(a)}return c}function d(a){var b=null;if(f(a),i&&i[a]){var c=i[a];b=c.exec("SELECT * FROM "+a),c.close()}return b}function e(a){return fs.existsSync(h(a))}function f(a){if(!i||!i[a]){var b=fs.readFileSync(h(a));i[a]=new SQL.Database(b)}}function g(a){if(i&&i[a]){var b=i[a],c=b["export"](),d=new Buffer(c);fs.writeFileSync(h(a),d)}}function h(a){return path.resolve(__dirname,"database",a)}var i=[];return{queryByString:b,updateByString:c,queryTableData:d,createWithData:a}}]);var angular=require("angular");angular.module("app.filter",[]).filter("filetype",[function(){return function(a,b){b=b.split(",");var c=a.match(/\.([\w\W]+)/)[1];return b.indexOf(c)>-1}}]);var angular=require("angular"),angularAnamiate=require("angular-animate"),angularAria=require("angular-aria"),angularMaterial=require("angular-material"),angularMdIcons=require("angular-material-icons"),app=angular.module("app",[angularAnamiate,angularAria,angularMaterial,angularMdIcons,"app.router","app.directive","app.controller","app.database","app.config","app.service","app.filter"]);app.run(["$rootScope","$state","$mdColors","settingService",function(a,b,c,d){a.mdPrimaryColor=c.getThemeColor("pink"),d.init()}]).config(["$mdThemingProvider",function(a){a.theme("default").primaryPalette("pink").accentPalette("orange")}]),app.bootstrap=function(){angular.bootstrap(window.document,["app"])},app.bootstrap();